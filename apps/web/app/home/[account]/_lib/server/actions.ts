'use server';

import { z } from 'zod';

import { enhanceAction } from '@kit/next/actions';

export const testWebhookUrlAction = enhanceAction(
  async ({ webhookUrl }) => {
    const res = await fetch(webhookUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        job_id: '3c709b29-1814-40ba-99d5-4d29fe05678f',
        result: [
          {
            UUID: '000eb6d5cc088fb899c69c2270',
            FIRST_NAME: 'Ryan',
            LAST_NAME: 'Lange',
            PERSONAL_ADDRESS: '',
            PERSONAL_CITY: '',
            PERSONAL_STATE: '',
            PERSONAL_ZIP: '',
            PERSONAL_ZIP4: '',
            AGE_RANGE: '',
            CHILDREN: '',
            GENDER: '',
            HOMEOWNER: '',
            MARRIED: '',
            NET_WORTH: '',
            INCOME_RANGE: '',
            DIRECT_NUMBER: '18055415854',
            DIRECT_NUMBER_DNC: 'Y',
            MOBILE_PHONE: '',
            MOBILE_PHONE_DNC: '',
            PERSONAL_PHONE: '18055415854',
            PERSONAL_PHONE_DNC: 'Y',
            BUSINESS_EMAIL: 'ryan.lange@sunrun.com',
            PERSONAL_EMAILS: '',
            DEEP_VERIFIED_EMAILS: '',
            SHA256_PERSONAL_EMAIL: '',
            SHA256_BUSINESS_EMAIL:
              'c788a5a2f827c218425133f3a60b40b4c44a982a2e1301b3473f3fc398570179',
            JOB_TITLE: 'Founder',
            HEADLINE: '',
            DEPARTMENT: 'Executive',
            SENIORITY_LEVEL: 'Cxo',
            INFERRED_YEARS_EXPERIENCE: '',
            COMPANY_NAME_HISTORY: null,
            JOB_TITLE_HISTORY: null,
            EDUCATION_HISTORY: '',
            COMPANY_ADDRESS: '225 Bush St',
            COMPANY_DESCRIPTION:
              'Sunrun is the leading home solar panel and battery storage company. Go solar for little to $0 down, lock in low energy rates. Get a quote today.',
            COMPANY_DOMAIN: 'sunrun.com',
            COMPANY_EMPLOYEE_COUNT: '10000+',
            COMPANY_LINKEDIN_URL: '',
            COMPANY_NAME: 'Sunrun',
            COMPANY_PHONE: '+18017626270',
            COMPANY_REVENUE: '',
            COMPANY_SIC: '1711,  1731,  5074',
            COMPANY_NAICS: '423720, 238220, 561110, 211, 5112',
            COMPANY_CITY: 'San Francisco',
            COMPANY_STATE: 'CA',
            COMPANY_ZIP: '94104',
            COMPANY_INDUSTRY: 'Environmental Services',
            LINKEDIN_URL: '',
            TWITTER_URL: '',
            FACEBOOK_URL: '',
            SOCIAL_CONNECTIONS: '',
            SKILLS: '',
            INTERESTS: '',
            SKIPTRACE_MATCH_SCORE: 0,
            SKIPTRACE_NAME: '',
            SKIPTRACE_ADDRESS: '',
            SKIPTRACE_CITY: '',
            SKIPTRACE_STATE: '',
            SKIPTRACE_ZIP: '',
            SKIPTRACE_LANDLINE_NUMBERS: '',
            SKIPTRACE_WIRELESS_NUMBERS: '',
            SKIPTRACE_CREDIT_RATING: '',
            SKIPTRACE_DNC: '',
            SKIPTRACE_EXACT_AGE: '',
            SKIPTRACE_ETHNIC_CODE: '',
            SKIPTRACE_LANGUAGE_CODE: '',
            SKIPTRACE_IP: '',
            SKIPTRACE_B2B_ADDRESS: '2965 South Angus Avenue',
            SKIPTRACE_B2B_PHONE: '2094097835',
            SKIPTRACE_B2B_SOURCE:
              'https://www.angi.com/companylist/us/ca/fresno/sunrun-reviews-11059068.htm',
            SKIPTRACE_B2B_WEBSITE: 'Sunrun.com',
            VALID_PHONES: '+112039531555, +113476039555',
          },
          {
            UUID: '00e68ecd5f2873052c841a9b32',
            FIRST_NAME: 'Luanne',
            LAST_NAME: 'Kadish',
            PERSONAL_ADDRESS: '',
            PERSONAL_CITY: '',
            PERSONAL_STATE: '',
            PERSONAL_ZIP: '',
            PERSONAL_ZIP4: '',
            AGE_RANGE: '',
            CHILDREN: '',
            GENDER: '',
            HOMEOWNER: '',
            MARRIED: '',
            NET_WORTH: '',
            INCOME_RANGE: '',
            DIRECT_NUMBER: '',
            DIRECT_NUMBER_DNC: '',
            MOBILE_PHONE: '',
            MOBILE_PHONE_DNC: '',
            PERSONAL_PHONE: '',
            PERSONAL_PHONE_DNC: '',
            BUSINESS_EMAIL: 'luanne.kadish@nike.com',
            PERSONAL_EMAILS: '',
            DEEP_VERIFIED_EMAILS: '',
            SHA256_PERSONAL_EMAIL: '',
            SHA256_BUSINESS_EMAIL:
              '0836c1d3e6cb6bfeae7e5c6c6b29fff3097329859fdf88c2859035816f01eec6',
            JOB_TITLE: 'Founder',
            HEADLINE: '',
            DEPARTMENT: 'Executive',
            SENIORITY_LEVEL: 'Cxo',
            INFERRED_YEARS_EXPERIENCE: '',
            COMPANY_NAME_HISTORY: null,
            JOB_TITLE_HISTORY: null,
            EDUCATION_HISTORY: '',
            COMPANY_ADDRESS: 'One Bowerman Drive',
            COMPANY_DESCRIPTION:
              'Nike delivers innovative products, experiences and services to inspire athletes.',
            COMPANY_DOMAIN: '',
            COMPANY_EMPLOYEE_COUNT: '10000+',
            COMPANY_LINKEDIN_URL: '',
            COMPANY_NAME: 'Nike',
            COMPANY_PHONE: '+15036716453',
            COMPANY_REVENUE: '',
            COMPANY_SIC: '',
            COMPANY_NAICS: '',
            COMPANY_CITY: 'Beaverton',
            COMPANY_STATE: 'OR',
            COMPANY_ZIP: '',
            COMPANY_INDUSTRY: 'Retail',
            LINKEDIN_URL: '',
            TWITTER_URL: '',
            FACEBOOK_URL: '',
            SOCIAL_CONNECTIONS: '',
            SKILLS: '',
            INTERESTS: '',
            SKIPTRACE_MATCH_SCORE: 0,
            SKIPTRACE_NAME: '',
            SKIPTRACE_ADDRESS: '',
            SKIPTRACE_CITY: '',
            SKIPTRACE_STATE: '',
            SKIPTRACE_ZIP: '',
            SKIPTRACE_LANDLINE_NUMBERS: '',
            SKIPTRACE_WIRELESS_NUMBERS: '',
            SKIPTRACE_CREDIT_RATING: '',
            SKIPTRACE_DNC: '',
            SKIPTRACE_EXACT_AGE: '',
            SKIPTRACE_ETHNIC_CODE: '',
            SKIPTRACE_LANGUAGE_CODE: '',
            SKIPTRACE_IP: '',
            SKIPTRACE_B2B_ADDRESS: 'One Bowerman Dr',
            SKIPTRACE_B2B_PHONE: '2406825844',
            SKIPTRACE_B2B_SOURCE:
              'https://www.buildzoom.com/contractor/nike-beaverton-or',
            SKIPTRACE_B2B_WEBSITE: '',
            VALID_PHONES: '112088619555',
          },
        ],
      }),
    });

    if (!res.ok) {
      throw new Error('Failed to send test notification');
    }
  },
  {
    schema: z.object({
      webhookUrl: z.string().trim().url(),
    }),
  },
);
